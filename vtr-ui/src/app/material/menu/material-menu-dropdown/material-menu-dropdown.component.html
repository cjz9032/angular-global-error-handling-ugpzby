<mat-menu #menuMain="matMenu"
	[hasBackdrop]="false"
	id="menu-main-nav-lnk-dropdown-toggle-{{dropdownMenu.id}}"
	class="vtr-material-menu-dropdown mt-0 overflow-wrap-normal max-width-none min-height-0 menu-dropdown-container {{dropdownMenu.id==='app-search' ? 'app-search' : ''}}"
	attr.aria-labelledby="menu-main-nav-lnk-dropdown-toggle-{{dropdownMenu.id}}"
	xPosition="before">
	<section *ngIf="dropdownMenu.id==='app-search'">
		<div mat-menu-item (focus)="onSearchItemFocus($event)">
			<vtr-search-dropdown ></vtr-search-dropdown>
		</div>
	</section>
	<section *ngIf="!hasSecondaryMenu && dropdownMenu.id!=='user'">
		<ng-container *ngFor="let subitem of dropdownMenu.subitems; let i=index">
			<button mat-menu-item
				*ngIf="subitem && !subitem.hide && subitem.externallink"
				id="menu-main-nav-lnk-dropdown-menu-external-{{parentId}}-{{i}}"
				class="mt-0 py-2 border-radius-0 text-lowercase outline-none h-auto dropdown-menu-item"
				attr.aria-label="{{subitem.label | translate }}"
				routerLinkActive="active"
				[routerLinkActiveOptions]="subitem.routerLinkActiveOptions"
				vtrMetrics
				[metricsEvent]="subitem.metricsEvent"
				[metricsParent]="subitem.metricsParent"
				[metricsItem]="subitem.metricsItem"
				target="_blank"
				rel="noopener"
				(click)="openExternalLink(subitem.path)">
				<span class="d-inline-block overflow-hidden w-auto" [innerHTML]="subitem.label | translate"></span>
			</button>
			<button mat-menu-item
				*ngIf="subitem && !subitem.hide && !subitem.externallink && !subitem.singleLayerRouting"
				id="menu-main-nav-lnk-dropdown-menu-{{parentId}}-{{i}}"
				class="mt-0 py-2 border-radius-0 text-lowercase outline-none h-auto dropdown-menu-item"
				attr.aria-label="{{subitem.label| translate}}"
				routerLinkActive="active"
				[routerLinkActiveOptions]="subitem.routerLinkActiveOptions"
				vtrMetrics
				[metricsEvent]="subitem.metricsEvent"
				[metricsParent]="subitem.metricsParent"
				[metricsItem]="subitem.metricsItem"
				routerLink="/{{parentPath}}/{{subitem.path}}"
				role="menuitem"
				(keydown.enter)="menuItemKeyDown(parentPath, subitem.path)">
				<span class="d-inline-block overflow-hidden w-auto" [innerHTML]="subitem.label | translate"></span>
			</button>
			<button mat-menu-item
				*ngIf="subitem && !subitem.hide && !subitem.externallink && subitem.singleLayerRouting"
				id="menu-main-nav-lnk-dropdown-menu-{{parentId}}-{{i}}"
				class="mt-0 py-2 border-radius-0 text-lowercase outline-none h-auto dropdown-menu-item"
				attr.aria-label="{{subitem.label| translate}}"
				routerLinkActive="active"
				[routerLinkActiveOptions]="subitem.routerLinkActiveOptions"
				vtrMetrics
				[metricsEvent]="subitem.metricsEvent"
				[metricsParent]="subitem.metricsParent"
				[metricsItem]="subitem.metricsItem"
				routerLink="/{{subitem.path}}"
				role="menuitem"
				(keydown.enter)="menuItemKeyDown(subitem.path)">
				<span class="d-inline-block overflow-hidden w-auto" [innerHTML]="subitem.label | translate"></span>
			</button>
		</ng-container>
	</section>
	<section *ngIf="hasSecondaryMenu && dropdownMenu.id!=='user'" class="d-flex p-3 secondary-menu-container">
		<section *ngFor="let subitem of dropdownMenu.subitems; let i=index"
			class="d-inline-block column-container">
			<button mat-menu-item
				*ngIf="subitem && !subitem.hide && subitem.externallink"
				id="menu-main-nav-lnk-dropdown-menu-external-{{parentId}}-{{i}}"
				class="d-inline-block mt-0 py-2 text-uppercase border-radius-0 outline-none h-auto dropdown-menu-item high-contrast-color-reversal font-weight-bold"
				disabled
				attr.aria-label="{{subitem.label | translate }}"
				target="_blank"
				rel="noopener">
				<span class="d-block overflow-hidden w-auto" [innerHTML]="subitem.label | translate"></span>
			</button>
			<button mat-menu-item
				*ngIf="subitem && !subitem.hide && !subitem.externallink"
				id="menu-main-nav-lnk-dropdown-menu-{{parentId}}-{{i}}"
				class="d-inline-block mt-0 py-2 text-uppercase border-radius-0 outline-none h-auto dropdown-menu-item high-contrast-color-reversal font-weight-bold"
				disabled
				attr.aria-label="{{subitem.label| translate}}"
				target="_blank"
				role="menuitem">
				<span class="d-block overflow-hidden w-auto" [innerHTML]="subitem.label | translate"></span>
			</button>
			<section *ngIf="subitem && !subitem.hide">
				<ng-container *ngFor="let secondarySubitem of subitem.subitems; let ii=index">
					<button mat-menu-item
						*ngIf="secondarySubitem && !secondarySubitem.hide && secondarySubitem.externallink"
						vtrMetrics
						id="menu-main-nav-lnk-dropdown-menu-external-{{parentId}}-{{subitem.id}}-{{ii}}"
						class="d-inline-block mt-0 py-2 border-radius-0 outline-none h-auto dropdown-menu-item"
						[ngClass]="{'text-lowercase': dropdownMenu.id !== 'security'}"
						attr.aria-label="{{secondarySubitem.label | translate }}"
						routerLinkActive="active"
						[routerLinkActiveOptions]="secondarySubitem.routerLinkActiveOptions"
						[metricsEvent]="secondarySubitem.metricsEvent"
						[metricsParent]="secondarySubitem.metricsParent"
						[metricsItem]="secondarySubitem.metricsItem"
						target="_blank"
						rel="noopener"
						(click)="openExternalLink(secondarySubitem.path)">
						<span class="d-inline-block overflow-hidden w-auto" [innerHTML]="secondarySubitem.label | translate"></span>
					</button>
					<button mat-menu-item
						*ngIf="secondarySubitem && !secondarySubitem.hide && !secondarySubitem.externallink && !secondarySubitem.singleLayerRouting"
						vtrMetrics
						id="menu-main-nav-lnk-dropdown-menu-{{parentId}}-{{subitem.id}}-{{ii}}"
						class="d-inline-block mt-0 py-2 border-radius-0 outline-none h-auto dropdown-menu-item"
						[ngClass]="{'text-lowercase': dropdownMenu.id !== 'security'}"
						attr.aria-label="{{secondarySubitem.label| translate}}"
						routerLinkActive="active"
						[routerLinkActiveOptions]="secondarySubitem.routerLinkActiveOptions"
						[metricsEvent]="secondarySubitem.metricsEvent"
						[metricsParent]="secondarySubitem.metricsParent"
						[metricsItem]="secondarySubitem.metricsItem"
						routerLink="/{{parentPath}}/{{subitem.path}}/{{secondarySubitem.path}}"
						role="menuitem"
						(keydown.enter)="menuItemKeyDown(parentPath, subitem.path, secondarySubitem.path)">
						<span class="d-inline-block overflow-hidden w-auto" [innerHTML]="secondarySubitem.label | translate"></span>
					</button>
					<button mat-menu-item
						*ngIf="secondarySubitem && !secondarySubitem.hide && !secondarySubitem.externallink && secondarySubitem.singleLayerRouting"
						vtrMetrics
						id="menu-main-nav-lnk-dropdown-menu-{{parentId}}-{{subitem.id}}-{{ii}}"
						class="d-inline-block mt-0 py-2 border-radius-0 outline-none h-auto dropdown-menu-item"
						[ngClass]="{'text-lowercase': dropdownMenu.id !== 'security'}"
						attr.aria-label="{{secondarySubitem.label| translate}}"
						routerLinkActive="active"
						[routerLinkActiveOptions]="secondarySubitem.routerLinkActiveOptions"
						[metricsEvent]="secondarySubitem.metricsEvent"
						[metricsParent]="secondarySubitem.metricsParent"
						[metricsItem]="secondarySubitem.metricsItem"
						routerLink="/{{secondarySubitem.path}}"
						role="menuitem"
						(keydown.enter)="menuItemKeyDown(secondarySubitem.path)">
						<span class="d-inline-block overflow-hidden w-auto" [innerHTML]="secondarySubitem.label | translate"></span>
					</button>
				</ng-container>
			</section>
		</section>
	</section>
</mat-menu>
