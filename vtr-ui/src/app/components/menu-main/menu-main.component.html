<div class="vtr-menu-main">
	<nav class="navbar navbar-expand-xl pr-0">
		<div *ngIf="!deviceService.isGaming && !isGamingHome"
			class="navbar-brand p-0">
			<img class="menu-main-logo"
				*ngIf="dashboardService.isDashboardDisplayed"
				[src]="VantageLogo | sanitize : 'resourceUrl'"
				alt="L" />
			<a vtrMetrics
				*ngIf="!dashboardService.isDashboardDisplayed && items && items.length>0"
				class="menu-main-logo"
				id="menu-main-lnk-l-logo"
				aria-label="menu-main-lnk-l-logo"
				tabindex="1"
				routerLinkActive="link-active"
				[routerLinkActiveOptions]="items[0].routerLinkActiveOptions"
				[metricsEvent]="items[0].metricsEvent"
				[metricsParent]="'NavBar'"
				[metricsItem]="items[0].metricsItem"
				routerLink="/dashboard">
				<img [src]="VantageLogo | sanitize : 'resourceUrl'"
					alt="L" />
			</a>
		</div>
		<div *ngIf="items.length> 0 && (deviceService.isGaming || loadMenuItem?.hideMenus)"
			class="navbar-brand pt-0 logo-y">

			<div *ngIf="isGamingHome">
				<img tabindex="0" [src]="headerLogo | sanitize : 'resourceUrl'"
					alt="L" />
			</div>
			<a id="menu-main-lnk-gaming-logo"
				aria-label="menu-main-lnk-gaming-logo"
				tabindex="1"
				*ngIf="!isGamingHome"
				vtrMetrics
				routerLinkActive="link-active"
				[attr.aria-label]="('gaming.common.narrator.mainMenuLink' | translate)"
				[routerLinkActiveOptions]="items[0].routerLinkActiveOptions"
				[metricsEvent]="items[0].metricsEvent"
				[metricsParent]="'NavBar'"
				[metricsItem]="items[0].metricsItem"
				routerLink="/{{items[0].path}}">
				<img [src]="headerLogo | sanitize : 'resourceUrl'"
					alt="L" />
			</a>

		</div>
		<div class="navbar-text clearfix">
			<span *ngIf="configService.appBrand && configService.appName">
				<div class="app-title">{{configService.appBrand}}
					<span role="text"
						class="app-name">{{configService.appName}}</span>
				</div>
			</span>
			<span>
				<div class="device-type">
					<span *ngIf="!machineFamilyName">&nbsp;</span>
					<span role="text"
						*ngIf="machineFamilyName">{{machineFamilyName}}</span>
					<vtr-ui-header-warranty *ngIf="machineFamilyName"
						[pageParent]="'NavBar'"></vtr-ui-header-warranty>
				</div>
			</span>

		</div>
		<a id="menu-main-btn-navbar-toggler"
			aria-label="menu-main-btn-navbar-toggler"
			class="navbar-toggler"
			tabindex="1"
			type="button"
			(click)="toggleMenu($event)"
			(keydown.enter)="toggleMenu($event)">
			<span class="navbar-toggler-icon">
				<fa-icon [icon]="['fas', 'bars']"></fa-icon>
			</span>
			<!-- <fa-icon [icon]="['fas', 'bars']">
					</fa-icon> -->
			<span role="text"
				class="unread-count-tag"
				*ngIf="appsForYouService.UnreadMessageCount.totalMessage">{{appsForYouService.UnreadMessageCount.totalMessage}}</span>
		</a>
		<div class="collapse navbar-collapse"
			*ngIf="!loadMenuItem?.hideMenus"
			#menuTarget
			[ngClass]="{'show':showMenu}">
			<ul class="navbar-nav ml-auto"
				*ngIf="loadMenuItem?.firstRunDate?.length || !deviceService.isShellAvailable">
				<ng-container *ngFor="let item of items; let i=index">
					<li *ngIf="item.subitems.length===0&&isCommomItem(item)&&showItem(item)"
						class="nav-item">
						<a class="nav-link {{item.id}}"
							[ngClass]="{'beta-item':item.beta}"
							vtrMetrics
							tabindex="1"
							id="menu-main-nav-lnk-{{item.id}}"
							attr.new-tip-id="new-tip-{{item.id}}"
							[metricsEvent]="item.metricsEvent"
							[metricsParent]="item.metricsParent"
							[metricsItem]="item.metricsItem"
							routerLink="/{{item.path}}"
							routerLinkActive="active"
							href="javascript:void(0)"
							(click)="onMenuItemClick(item)"
							(keydown.enter)="onMenuItemClick(item); menuItemKeyDown(item.path)"
							*ngIf="item.label | translate">
							<div class="icon">
								<fa-icon *ngIf="item.icon[0]!=='icomoon'"
									[icon]="item.icon"
									class="fa-icon"></fa-icon>
								<span *ngIf="item.icon[0]==='icomoon'"
									[ngClass]="['navbar-icon',item.icon[0],item.icon[1]]"></span>
							</div>

							{{item.label | translate}}
							<span *ngIf="item.beta"
								class="beta">Beta</span>
						</a>
					</li>
					<li ngbDropdown
						#menuDropDown="ngbDropdown"
						*ngIf="item.subitems.length>0
						&&isCommomItem(item)
						&&showItem(item)"
						class="nav-item dropdown"
						(mouseover)="[closeAllOtherDD(menuDropDown),menuDropDown.open()]"
						(mouseleave)="menuDropDown.close()"
						[ngClass]="{'active': isParentActive(item)}">
						<a ngbDropdownToggle
							class="nav-link dropdown-toggle {{item.id}}"
							[ngClass]="{'beta-item':item.beta,'dropdown-toggle': true}"
							vtrMetrics
							tabindex="1"
							id="menu-main-nav-lnk-dropdown-toggle-{{item.id}}"
							attr.aria-label="{{item.id}}"
							attr.new-tip-id="new-tip-{{item.id}}"
							[metricsEvent]="item.metricsEvent"
							[metricsParent]="item.metricsParent"
							[metricsItem]="item.metricsItem"
							routerLink="/{{item.path}}"
							routerLinkActive="active"
							data-toggle="dropdown"
							aria-haspopup="true"
							aria-expanded="false"
							href="javascript:void(0)"
							(focus)="[closeAllOtherDD(menuDropDown),menuDropDown.open()]"
							(click)="onMenuItemClick(item)"
							(keydown.enter)="[onMenuItemClick(item),menuItemKeyDown(item.path)]"
							role="menu"
							*ngIf="item.label | translate">
							<div class="icon">
								<fa-icon [icon]="item.icon"
									class="fa-icon"></fa-icon>
							</div>
							{{item.label | translate}}
							<span *ngIf="item.beta"
								class="beta">Beta</span>
						</a>
						<div ngbDropdownMenu
							id="menu-main-nav-lnk-dropdown-toggle-{{item.id}}"
							class="dropdown-menu"
							attr.aria-labelledby="menu-main-nav-lnk-dropdown-toggle-{{item.id}}">
							<fa-icon [icon]="['fas', 'square']"
								class="menu-pointer"></fa-icon>
							<span *ngFor="let subitem of item.subitems; let ii=index">
								<a ngbDropdownItem
									*ngIf="subitem.externallink && showItem(subitem)"
									vtrMetrics
									tabindex="1"
									id="menu-main-nav-lnk-dropdown-menu-external-{{item.id}}-{{ii}}"
									attr.aria-label="{{subitem.label | translate }}"
									routerLinkActive="link-active"
									[routerLinkActiveOptions]="subitem.routerLinkActiveOptions"
									[metricsEvent]="subitem.metricsEvent"
									[metricsParent]="subitem.metricsParent"
									[metricsItem]="subitem.metricsItem"
									class="dropdown-item link"
									target="_blank"
									rel="noopener"
									href="javascript:void(0)"
									(keydown)="showHideMenuOfItem($event,menuDropDown)"
									(click)="[onMenuItemClick(subitem),openExternalLink(subitem.path)]"
									(keydown.enter)="[onMenuItemClick(subitem), openExternalLink(subitem.path)]">{{subitem.label | translate}}</a>
								<a ngbDropdownItem
									*ngIf="!subitem.externallink && showItem(subitem)"
									vtrMetrics
									tabindex="1"
									id="menu-main-nav-lnk-dropdown-menu-{{item.id}}-{{ii}}"
									attr.aria-label="{{subitem.label| translate}}"
									routerLinkActive="link-active"
									[routerLinkActiveOptions]="subitem.routerLinkActiveOptions"
									[metricsEvent]="subitem.metricsEvent"
									[metricsParent]="subitem.metricsParent"
									[metricsItem]="subitem.metricsItem"
									class="dropdown-item link"
									routerLink="/{{item.path}}/{{subitem.path}}"
									(click)="onMenuItemClick(subitem)"
									(keydown)="showHideMenuOfItem($event,menuDropDown)"
									(keydown.enter)="[onMenuItemClick(subitem), menuItemKeyDown(item.path, subitem.path)]"
									href="javascript:void(0)"
									role="menuitem">{{subitem.label | translate}}</a>
							</span>

						</div>
					</li>
					<li *ngIf="item.id==='app-search'&&showItem(item)"
						class="nav-item search-nav-item">
						<div class="search-nav-item-mask"
							*ngIf="showSearchBox"
							id="search-nav-item-mask"
							attr.aria-label="search-nav-item-mask"
							tabindex="1"
							(click)="onClickSearchMask()"
							(keydown.enter)="onClickSearchMask()"></div>
						<a class="nav-link {{item.id}}"
							[ngClass]="{'beta-item':item.beta}"
							[class.search-active]="showSearchBox"
							vtrMetrics
							tabindex="1"
							id="menu-main-nav-lnk-{{item.id}}"
							attr.new-tip-id="new-tip-{{item.id}}"
							attr.aria-label="{{item.label | translate}}"
							[metricsEvent]="item.metricsEvent"
							[metricsParent]="item.metricsParent"
							[metricsItem]="item.metricsItem"
							href="javascript:void(0)"
							(click)="onMenuItemClick(item, $event)"
							(keydown.enter)="onMenuItemClick(item, $event)"
							*ngIf="item.label | translate">
							<div class="icon">
								<fa-icon *ngIf="item.icon[0]!=='icomoon'"
									[icon]="item.icon"
									class="fa-icon"></fa-icon>
								<span *ngIf="item.icon[0]==='icomoon'"
									[ngClass]="['navbar-icon',item.icon[0],item.icon[1]]"></span>
							</div>

							{{item.label | translate}}
							<span *ngIf="item.beta"
								class="beta">Beta</span>
						</a>
						<div class="search-dropdown d-none d-md-block"
							*ngIf="showSearchBox">
							<vtr-search-dropdown></vtr-search-dropdown>
						</div>
					</li>
					<li ngbDropdown
						#menuDropDown="ngbDropdown"
						(mouseover)="[closeAllOtherDD(menuDropDown),menuDropDown.open()]"
						(mouseleave)="menuDropDown.close()"
						*ngIf="item.id==='user' && languageService.isLanguageLoaded"
						class="nav-item dropdown">
						<!-- <a class="nav-link dropdown-toggle {{item.id}}"
									routerLink="/{{item.path}}"
									routerLinkActive="active"
									id="navbarDropdown"
									role="button"
									data-toggle="dropdown"
									aria-haspopup="true"
									aria-expanded="false">
									<div class="user-initials">
										{{userService.initials}}
									</div>
								</a> -->

						<a ngbDropdownToggle
							class="nav-link {{item.id}}"
							id="navbarDropdown"
							attr.aria-label="navbarDropdown"
							[ngClass]="{'dropdown-toggle': true}"
							role="menu"
							tabindex="1"
							data-toggle="dropdown"
							aria-haspopup="true"
							aria-expanded="false"
							href="javascript:void(0)"
							(focus)="[closeAllOtherDD(menuDropDown),menuDropDown.open()]"
							(click)="onMenuItemClick(item)"
							(keydown.enter)="onMenuItemClick(item)">
							<div class="user-initials">
								{{deviceService.isArm || userService.starter || !commonService.isOnline || !userService.isLenovoIdSupported() ? 'L' : userService.initials }}
							</div>
							<span class="unread-count-tag"
								*ngIf="!deviceService.isArm && appsForYouService.UnreadMessageCount.totalMessage">{{appsForYouService.UnreadMessageCount.totalMessage}}</span>
						</a>
						<div ngbDropdownMenu
							class="dropdown-menu {{item.id}} dropdown-menu-id"
							id="navbarDropdownMenu"
							aria-labelledby="navbarDropdown">
							<div class="dropdown-item"
								role="text"
								id="menu-main-text-hello-user"
								*ngIf="!deviceService.isArm && commonService.isOnline && userService.isLenovoIdSupported()">
								{{'lenovoId.helloUser' | translate:{firstName:userService.firstName} }}
							</div>
							<a ngbDropdownItem
								*ngIf="appsForYouService.showLmaMenu()"
								class="dropdown-item link link-lma"
								tabindex="1"
								vtrMetrics
								id="menu-main-lnk-open-lma"
								attr.aria-label="menu-main-lnk-open-lma"
								[metricsEvent]="item.metricsEvent"
								[metricsParent]="item.metricsParent"
								metricsItem="LenovoMigrationAssistantButton"
								[routerLink]="['/apps-for-you/'+appsForYouEnum.AppGuidLenovoMigrationAssistant]"
								tabindex="1"
								href="javascript:void(0)"
								(keydown)="showHideMenuOfItem($event,menuDropDown)"
								(click)="onMenuItemClick(item, $event)"
								(keydown.enter)="[onMenuItemClick(item, $event), menuItemKeyDown('apps-for-you', appsForYouEnum.AppGuidLenovoMigrationAssistant)]"
								href="javascript:void(0)">
								{{ 'appsForYou.menuText.lenovoMigrationAssistant' | translate }}
								<span class="unread-tag"
									*ngIf="!appsForYouService.UnreadMessageCount.lmaMenuClicked"></span>
							</a>
							<a ngbDropdownItem
								*ngIf="appsForYouService.showAdobeMenu()"
								class="dropdown-item link link-adobe"
								tabindex="1"
								vtrMetrics
								id="menu-main-lnk-open-adobe"
								attr.aria-label="menu-main-lnk-open-adobe"
								[metricsEvent]="item.metricsEvent"
								[metricsParent]="item.metricsParent"
								metricsItem="AdobecRedemptionButton"
								[routerLink]="['/apps-for-you/'+ appsForYouEnum.AppGuidAdobeCreativeCloud]"
								href="javascript:void(0)"
								(keydown)="showHideMenuOfItem($event,menuDropDown)"
								(click)="onMenuItemClick(item, $event)"
								(keydown.enter)="[onMenuItemClick(item, $event), menuItemKeyDown('/apps-for-you/', appsForYouEnum.AppGuidAdobeCreativeCloud)]"
								href="javascript:void(0)">
								{{ 'appsForYou.menuText.adobeRedemption' | translate }}
								<span class="unread-tag"
									*ngIf="!appsForYouService.UnreadMessageCount.adobeMenuClicked"></span>
							</a>
							<a ngbDropdownItem
								*ngIf="commonService.isOnline && appsForYouService.showDccMenu()"
								class="dropdown-item link link-dcc"
								tabindex="1"
								vtrMetrics
								id="menu-main-lnk-open-dcc"
								attr.aria-label="menu-main-lnk-open-dcc"
								[metricsEvent]="item.metricsEvent"
								[metricsParent]="item.metricsParent"
								metricsItem="DccRedemptionButton"
								(keydown)="showHideMenuOfItem($event,menuDropDown)"
								(click)="onMenuItemClick(item, $event)"
								(keydown.enter)="onMenuItemClick(item, $event)"
								href="javascript:void(0)">
								{{ 'dcc.menuText.lenovoDigitalOffer' | translate }}
								<span class="unread-tag"
									*ngIf="!appsForYouService.UnreadMessageCount.dccMenuClicked"></span>
							</a>
							<a ngbDropdownItem
								*ngIf="commonService.isOnline && !deviceService.isSMode && modernPreloadService.IsEntitled"
								vtrMetrics
								tabindex="1"
								id="menu-main-lnk-open-modern-preload"
								attr.aria-label="menu-main-lnk-open-modern-preload"
								[metricsEvent]="item.metricsEvent"
								[metricsParent]="item.metricsParent"
								metricsItem="ModernPreloadButton"
								class="dropdown-item link"
								href="javascript:void(0)"
								(keydown)="showHideMenuOfItem($event,menuDropDown)"
								(click)="openModernPreloadModal()">{{ 'modernPreload.title' | translate }}</a>
							<a ngbDropdownItem
								vtrMetrics
								tabindex="1"
								id="menu-main-lnk-open-preference"
								attr.aria-label="menu-main-lnk-open-preference"
								[metricsEvent]="item.metricsEvent"
								[metricsParent]="item.metricsParent"
								metricsItem="SettingsButton"
								class="dropdown-item link"
								href="javascript:void(0)"
								routerLink="settings"
								(keydown)="showHideMenuOfItem($event,menuDropDown)"
								(click)="onMenuItemClick(item)"
								(keydown.enter)="[onMenuItemClick(item), menuItemKeyDown('settings')]">{{ 'settings.preferenceSettings' | translate }}</a>
							<a ngbDropdownItem
								*ngIf="commonService.isOnline"
								vtrMetrics
								tabindex="1"
								id="menu-main-lnk-open-feedback"
								attr.aria-label="menu-main-lnk-open-feedback"
								[metricsEvent]="item.metricsEvent"
								[metricsParent]="item.metricsParent"
								metricsItem="GiveFeedbackButton"
								class="dropdown-item link"
								href="javascript:void(0)"
								(keydown)="showHideMenuOfItem($event,menuDropDown)"
								(click)="openFeedbackModal()">{{ 'dashboard.feedback.title' | translate }}</a>
							<a ngbDropdownItem
								*ngIf="!deviceService.isArm && !userService.auth && !userService.starter && commonService.isOnline && userService.isLenovoIdSupported()"
								vtrMetrics
								tabindex="1"
								id="menu-main-lnk-open-lenovoid-login"
								attr.aria-label="menu-main-lnk-open-lenovoid-login"
								[metricsEvent]="item.metricsEvent"
								[metricsParent]="item.metricsParent"
								metricsItem="LenovoIdSignInButton"
								class="dropdown-item link"
								href="javascript:void(0)"
								(keydown)="showHideMenuOfItem($event,menuDropDown)"
								(click)="OpenLenovoId('NavigationLenovoAccount.Submenu'); onMenuItemClick(item)"
								(keydown.enter)="[OpenLenovoId('NavigationLenovoAccount.Submenu'), onMenuItemClick(item)]">{{'lenovoId.login' | translate}}</a>
							<a ngbDropdownItem
								*ngIf="!deviceService.isArm && !userService.auth && userService.starter && commonService.isOnline && userService.isLenovoIdSupported()"
								vtrMetrics
								tabindex="1"
								id="menu-main-lnk-open-lenovoid-unlock"
								attr.aria-label="menu-main-lnk-open-lenovoid-unlock"
								[metricsEvent]="item.metricsEvent"
								[metricsParent]="item.metricsParent"
								metricsItem="LenovoIdStarterIdButton"
								class="dropdown-item link"
								href="javascript:void(0)"
								(keydown)="showHideMenuOfItem($event,menuDropDown)"
								(click)="OpenLenovoId('NavigationLenovoAccount.Submenu'); onMenuItemClick(item)"
								(keydown.enter)="[OpenLenovoId('NavigationLenovoAccount.Submenu'), onMenuItemClick(item)]">{{'lenovoId.unlockExclusives' | translate}}</a>
							<a ngbDropdownItem
								*ngIf="!deviceService.isArm && userService.auth && commonService.isOnline && userService.isLenovoIdSupported()"
								vtrMetrics
								tabindex="1"
								id="menu-main-lnk-user-logout"
								attr.aria-label="menu-main-lnk-user-logout"
								[metricsEvent]="item.metricsEvent"
								[metricsParent]="item.metricsParent"
								metricsItem="LenovoIdSignOutButton"
								class="dropdown-item link"
								href="javascript:void(0)"
								(keydown)="showHideMenuOfItem($event,menuDropDown)"
								(click)="onLogout(); onMenuItemClick(item)"
								[class.disabled]="isLoggingOut"
								(keydown.enter)="[onLogout(), onMenuItemClick(item)]">{{ isLoggingOut ? ('lenovoId.loggingOut' | translate) : ('lenovoId.logout' | translate) }}</a>
						</div>
					</li>
					<div class="d-none">
						<img *ngFor="let i of preloadImages"
							[src]="i"
							alt="">
					</div>
				</ng-container>
			</ul>
		</div>
	</nav>
	<div class="search-dropdown-sm d-xl-none"
		*ngIf="showSearchBox">
		<vtr-search-dropdown></vtr-search-dropdown>
	</div>
	<vtr-search-tips [featureDesc]="searchTips"
		*ngIf="!showSearchBox && searchTips"></vtr-search-tips>
</div>
