<div class="vtr-battery-card"
	*ngIf="isLoading">
	<div class="container p-5"
		[style.height.px]="292">
		<div class="loader center-block">
			<div class="spinner-border progress-spinner"
				id="battery-card-spinner"
				role="status"></div>
		</div>
	</div>
</div>
<div class="vtr-battery-card"
	*ngIf="!isLoading">
	<!-- Battery Details Popup Modal -->
	<ng-template #batteryDetail
		let-modal
		aria-describedby="heading">
		<div class="modal-header"
			role="modal"
			aria-describedby="heading">
			<h4 class="modal-title battery-detail-modal-title pl-5"
				id="heading">
				{{'device.deviceSettings.batteryGauge.details.title' | translate }}
			</h4>
			<button type="button"
				class="close-button bg-white"
				id="myDevice-settings-battery-details-card-close-icon"
				aria-label="battery details card close"
				role="button"
				tabindex="0"
				(click)="modal.dismiss('Cross click')"
				(keydown.esc)="modal.dismiss('Cross click')">
				<fa-icon [icon]="['fal', 'times']"></fa-icon>

			</button>
		</div>
		<div class="modal-body">
			<vtr-battery-detail [dataInfo]="batteryInfo"
				[dataIndicator]="batteryIndicator"
				[dataConditions]="batteryConditions"> </vtr-battery-detail>
		</div>
	</ng-template>
	<!-- End Battery Details Modal -->

	<div class="container p-5 battery-panel-background">
		<h3 class="battery-health"
			id="myDevice-settings-batteryGauge-subtitle">
			{{'device.deviceSettings.batteryGauge.subtitle' | translate}}
		</h3>
		{{batteryIndicator.percent == 0 && flag ? reInitValue(): ""}}
		<div class="pt-4 battery-frame pr-3">
			<vtr-battery-indicator [remainingHour]="batteryIndicator.hours"
				[isWinRTLoading]="isWinRTLoading"
				[remainingMinutes]="batteryIndicator.minutes"
				[percentage]="batteryIndicator.percent"
				[isCharging]="batteryIndicator.charging"
				[isExpressCharging]="batteryIndicator.expressCharging"
				[batteryNotDetected]="batteryIndicator.batteryNotDetected"
				[timeText]="batteryIndicator.timeText"
				[isAirplaneMode]="batteryIndicator.isAirplaneMode"
				[isChargeThresholdOn]="batteryIndicator.isChargeThresholdOn">
			</vtr-battery-indicator>
		</div>

		<div class="row px-3"
			*ngFor="let batteryConditionNote of batteryConditionNotes; let i = index">
			<!-- Battery Condition tip icon -->
			<div class="p-0 pr-2 col-auto"
				id="batteryConditionNote{{i}}"
				*ngIf="batteryConditions[i].condition!= batteryConditionsEnum.FullACAdapterSupport">
				<!-- Good -->
				<span role="img"
					id="batteryConditionIcon-GoodBattery"
					*ngIf="batteryConditions[i].conditionStatus == batteryStatus.Good"
					class="icomoon icomoon-ConditionGoodBattery"></span>
				<!-- Fair -->
				<span role="img"
					id="batteryConditionIcon-FairBattery"
					*ngIf="batteryConditions[i].conditionStatus == batteryStatus.Fair"
					class="icomoon icomoon-ConditionFairBattery"></span>
				<!-- Poor -->
				<span role="img"
					id="batteryConditionIcon-BadBattery"
					*ngIf="batteryConditions[i].conditionStatus == batteryStatus.Poor &&
				batteryConditions[i].condition!=batteryConditionsEnum.Error"
					class="icomoon icomoon-ConditionBadBattery"></span>
				<!-- Adapter error conditions -->
				<span role="img"
					id="batteryConditionIcon-ACAdapter-notSupported"
					*ngIf="batteryConditions[i].condition==batteryConditionsEnum.NotSupportACAdapter"
					class="icomoon icomoon-ConditionACAdapterError"></span>
			</div>
			<!-- Full Support Adapter and acWattage > 0 -->
			<div *ngIf="batteryConditions[i].condition == batteryConditionsEnum.FullACAdapterSupport && acAdapterInfoParams && acAdapterInfoParams.acWattage!=0"
				class="p-0 pr-2 col-auto adapter-support">
				<span class="icomoon icomoon-ConditionACAdapterError"
					role="img"
					id="icon-FullACAdapterSupport"></span>
			</div>
			<!-- End Icons -->

			<!-- Battery Condition tip Text -->
			<div class='col battery-conditions-tips'>
				<!-- For storage limitation conditions(Only in ThinkPads) -->
				<h6 [innerHTML]="batteryConditionNote | translate:param"
					*ngIf="batteryConditions[i].condition==batteryConditionsEnum.StoreLimitation"
					[id]="'battery-condition-tip-'+ batteryConditionsEnum[batteryConditions[i].condition]"></h6>
				<!-- For full support adapter with wattage > 0  -->
				<h6 [innerHTML]="batteryConditionNote | translate:acAdapterInfoParams"
					*ngIf="batteryConditions[i].condition==batteryConditionsEnum.FullACAdapterSupport && acAdapterInfoParams && acAdapterInfoParams.acWattage!=0"
					[id]="'battery-condition-tip-'+ batteryConditionsEnum[batteryConditions[i].condition]"></h6>
				<!-- for  all tips which does not contain any value to be added in translate string -->
				<h6 [innerHTML]="batteryConditionNote | translate"
					*ngIf="batteryConditions[i].condition!=batteryConditionsEnum.StoreLimitation && batteryConditions[i].condition!=batteryConditionsEnum.Error && batteryConditions[i].condition!=batteryConditionsEnum.FullACAdapterSupport"
					[id]="'battery-condition-tip-'+ batteryConditionsEnum[batteryConditions[i].condition]"></h6>
				<!-- see details link in case of short adapter note -->
				<a *ngIf="batteryConditions[i].conditionStatus===batteryStatus.AcAdapterStatus && batteryConditions[i].condition!=batteryConditionsEnum.FullACAdapterSupport && shortAcErrNote"
					class="link-label"
					(click)="showDetailTip(i)"
					(keydown.enter)="showDetailTip(i)"
					id="battery-condition-tip-ACAdapterError-seeDetails-link"
					role="link">{{'device.deviceSettings.batteryGauge.seeDetailsLink' | translate}}</a>
			</div>
		</div>

		<!-- Note in case of charge threshold on or Gauge reset is in progress -->
		<div class="feature-note p-3 mt-2"
			*ngIf="!batteryService.isInvalidBattery && (batteryIndicator.isChargeThresholdOn || batteryService.isGaugeResetRunning) ">
			<div class="row"
				id="myDevice-settings-batteryGauge-note">
				<p role="text">
					<!-- Override gauge reset over charge threshold -->
					<span role="text"
						*ngIf="!batteryService.isGaugeResetRunning"
						[innerHTML]="'device.deviceSettings.batteryGauge.thresholdNote' | translate"
						id="batteryGauge-thresholdNote"></span>
					<span *ngIf="batteryService.isGaugeResetRunning"
						[innerHTML]="'device.deviceSettings.batteryGauge.gaugeResetWarning' | translate"
						id="batteryGauge-gaugeResetWarning"></span>
				</p>
			</div>
		</div>

		<div class="pt-4 text-center"
			[class.btn-disabled]="disableBatteryDetails">
			<vtr-ui-button [isFullWidth]="true"
				[metricsItem]="'btn.see-battery-details'"
				[metricsParent]="metricsParent"
				[metricsEvent]="metricsType"
				(click)="showDetailModal(batteryDetail)"
				[isDisabled]="disableBatteryDetails"
				id="myDevice-settings-battery-details-btn"
				[alreadyJoinGroup]="'groupNone'"
				[linkId]="'myDevice-settings-battery-details-btn'"
				[label]="'device.deviceSettings.batteryGauge.button' | translate"
				attr.aria-label="myDevice-settings-battery-details-btn"
				[attr.aria-disabled]="disableBatteryDetails">
			</vtr-ui-button>


		</div>
	</div>
</div>
