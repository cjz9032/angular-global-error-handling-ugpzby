<div class="breached-account"
	 [ngClass]="{'breached-account_open': i === openId}"
	 *ngFor="let account of breachedAccountsForShow;
	 trackBy: trackByBreachedAccount; let i = index">
	<div class="breached-account__preview" >
		<div class="breached-account__image">
			<ng-template #defaultFavicon>
				<img class="breached-account__img" src="assets/images/privacy-tab/Unknown.png" alt="unknown favicon">
			</ng-template>
			<img class="breached-account__img"
				 *ngIf="account.domain | sitesFavicon:'/assets/images/privacy-tab/Unknown.png' | async as favicon; else defaultFavicon"
				 [src]="account.image || favicon"
				 [alt]="account.domain">
			<div class="breached-account__count"
					   *ngIf="account.domain === 'n/a'">
			{{otherBreaches.length > 99 ? '99+' : otherBreaches.length}}
		</div>
		</div>
        <div class="breached-account__text">
            <div class="breached-account__social">
                <div class="breached-account__social-description">
                    <h4 class="breached-account__title">{{transformDomain(account.domain)}}</h4>
                    <p class="breached-account__date"
					   *ngIf="openId !== i && account.domain !== 'n/a'"
                       title="{{account.date}}">Breached on {{isFigleafReadyForCommunication ? account.date : (account.date | date:'MMM d, y')}}</p>
                </div>
            </div>

			<div class="breached-account__chips" *ngIf="openId !== i">
				<span class="breached-account__chips-item breached-account__chips-item--password"
					  *ngIf="account.hasPassword || account.password">Password</span>
				<span class="breached-account__chips-item breached-account__chips-item--email"
					  *ngIf="account.hasEmail || account.email">Email</span>
			</div>

            <div class="breached-account__details">
                <button class="breached-account__accordion-button"
                        *ngIf="isUserAuthorized || isFigleafReadyForCommunication"
                        vtrSendAnalytics
                        [metricsEvent]="'ItemClick'"
                        [metricsItem]="'BreachedAccountsDetailItem'"
                        [ngClass]="{
                        	'breached-account__accordion-button--open': openId === i,
                        	'breached-account__accordion-button--to-right': isFigleafReadyForCommunication
                        }"
                        (click)="isFigleafReadyForCommunication ? openFigleafEmit(account.link) : openAccordion(i)">
                    <span>Details</span>
                </button>
            </div>
        </div>
	</div>

	<div *ngIf="openId === i" class="breached-account__description" data-analyticsName="Details">
		<vtr-breached-description
			*ngIf="account.domain !== 'n/a'"
			[breachedAccount]="account">
		</vtr-breached-description>
		<vtr-breached-other-description
			*ngIf="account.domain === 'n/a'"
			[setBreachData]="otherBreaches">
		</vtr-breached-other-description>

		<vtr-try-product-block
			[texts]="tryProductText">
		</vtr-try-product-block>
	</div>
</div>
<div class="breached-account breached-account--unverify" *ngIf="unverifyBreaches.length > 0">
	<div class="breached-account__preview">
		<div class="breached-account__image">
			<img class="breached-account__img"
				 src="assets/images/privacy-tab/unverify.png"
				 srcset="assets/images/privacy-tab/unverify@2x.png 2x"
				 alt="unverify icon">
		</div>
		<div class="breached-account__text">
			<div class="breached-account__social breached-account__social--unverify">
				<div class="breached-account__social-description">
					<h4 class="breached-account__title"><span class="breached-account__title--red">{{unverifyBreaches.length}}</span> breached accounts â€” verify your email for details</h4>
				</div>
			</div>
			<div class="breached-account__details" *ngIf="isFigleafReadyForCommunication">
				<button class="breached-account__accordion-button breached-account__accordion-button--to-right"
						vtrSendAnalytics
						[metricsEvent]="'ItemClick'"
						[metricsItem]="'SeeInAppVerify'"
						(click)="openFigleafEmit('')">
					<span>Details</span>
				</button>
			</div>
		</div>
	</div>
</div>
<div *ngIf="openId === null">
	<vtr-try-product-block
		[isFigleafReadyToCommunication]="isFigleafReadyForCommunication"
		[texts]="tryProductText">
	</vtr-try-product-block>
</div>
