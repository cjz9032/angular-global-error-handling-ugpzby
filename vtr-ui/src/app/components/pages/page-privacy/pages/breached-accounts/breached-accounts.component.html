<section class="breaches-page"
		 vtrSendAnalytics
		 [metricsEvent]="'PageView'">

	<div class="breaches-page__header" *ngIf="!(isShowVerifyBlock$ | async)">
		<vtr-feature-header
			class="breaches-page__feature-header"
			[texts]="textForFeatureHeader"
			[isFeatureWasScanned]="breachedAccountWasScanned$ | async"
			[countOfIssue]="breachedAccountsCount$ | async"
			[isFigleafReadyToCommunication]="isFigleafReadyForCommunication$ | async">
			<span class="breaches-page__title--red">{{breachedAccountsCount$ | async}}</span> breached accounts found
		</vtr-feature-header>

		<button class="breaches-page__button"
				*ngIf="(isFigleafReadyForCommunication$ | async) && !(breachedAccounts$ | async)?.length"
				vtrSendAnalytics
				[metricsEvent]="'ItemClick'"
				[metricsItem]="'ViewInLenovoPrivacyEssentialsButton'"
				(click)="openFigleafApp()">
			View now
		</button>

		<button class="breaches-page__button"
				*ngIf="(isFigleafReadyForCommunication$ | async) && (breachedAccounts$ | async)?.length"
				vtrSendAnalytics
				[metricsEvent]="'ItemClick'"
				[metricsItem]="'BreachedAccountsFixInLenovoPrivacyButton'"
				(click)="openFigleafApp()">
			Fix in Lenovo Privacy Essentials
		</button>

		<div class="breaches-page__tooltip"
			 *ngIf="!(isBreachedFoundAndUserNotAuthorizedWithoutFigleaf$ | async) &&
					!(isFigleafReadyForCommunication$ | async) &&
					(breachedAccounts$ | async)?.length > 0">
			<vtr-why-seeing-tooltip [contextText]="textForTooltip">
			</vtr-why-seeing-tooltip>
		</div>
	</div>

	<div class="breached-accounts" data-analyticsName="BreachedAccountsBlock">
		<vtr-email-scanner
			class="breached-accounts__email-scanner"
			*ngIf="(isUndefinedWithoutFigleafState$ | async)"
			[scanCounter]="scanCounter$ | async"
			[emailWasScanned]="breachedAccountWasScanned$ | async">
		</vtr-email-scanner>
		<vtr-breached-account
			*ngIf="(((isAccountVerify$ | async) && (isFigleafReadyForCommunication$ | async))
					|| ((isUserAuthorized$ | async) && !(isFigleafReadyForCommunication$ | async)) && (breachedAccounts$ | async)?.length)"
			[breachedAccounts]="(breachedAccounts$ | async)"
			[isUserAuthorized]="isUserAuthorized$ | async"
			[isFigleafReadyForCommunication]="isFigleafReadyForCommunication$ | async"
			(openFigleaf)="openFigleafByUrl($event)">
		</vtr-breached-account>

		<vtr-verify-email
			*ngIf="(isShowVerifyBlock$ | async)"
			[isFigleafReadyForCommunication]="isFigleafReadyForCommunication$ | async"
			[userEmail]="userEmail$ | async"
			[breachedAccountsLength]="(breachedAccounts$ | async)?.length"
			(verifyEmailEmit)="startVerify()">
		</vtr-verify-email>

		<div class="breached-accounts__clear-data-wrapper" *ngIf="(userEmail$ | async) && !(isFigleafReadyForCommunication$ | async)">
			<vtr-clear-data-tooltip [feature]="breachedFeatureName"></vtr-clear-data-tooltip>
		</div>

	</div>
</section>
