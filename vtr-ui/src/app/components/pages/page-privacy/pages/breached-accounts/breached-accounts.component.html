<section class="breaches-page"
		 vtrSendAnalytics
		 [metricsEvent]="'PageView'">

	<div class="breaches-page__header">
		<vtr-feature-header
			[texts]="textForFeatureHeader"
			[isFeatureWasScanned]="emailWasScanned$ | async"
			[countOfIssue]="breachedAccountsCount$ | async"
			[isFigleafReadyToCommunication]="isFigleafReadyForCommunication$ | async">
			<span class="breaches-page__title--red">{{breachedAccountsCount$ | async}}</span> breached accounts found
		</vtr-feature-header>

		<button class="breaches-page__button"
				*ngIf="isBreachedFoundAndUserNotAuthorizedWithoutFigleaf$ | async"
				(click)="startVerify()">
			Verify email
		</button>

		<button class="breaches-page__button"
				*ngIf="(isFigleafReadyForCommunication$ | async) && !(breachedAccounts$ | async)?.length"
				(click)="openFigleafApp()">
			View in Lenovo Privacy Essentials
		</button>

		<button class="breaches-page__button"
				*ngIf="(isFigleafReadyForCommunication$ | async) && (breachedAccounts$ | async)?.length"
				(click)="openFigleafApp()">
			Fix in Lenovo Privacy Essentials
		</button>

		<div class="breaches-page__tooltip"
			 *ngIf="!(isBreachedFoundAndUserNotAuthorizedWithoutFigleaf$ | async) &&
					!(isFigleafReadyForCommunication$ | async) &&
					(breachedAccounts$ | async)?.length > 0">
			<vtr-why-seeing-tooltip [contextText]="textForTooltip">
			</vtr-why-seeing-tooltip>
		</div>
	</div>

	<div class="breached-accounts" data-analyticsName="BreachedAccountsBlock">
		<vtr-email-scanner
			*ngIf="isUndefinedWithoutFigleafState$ | async"
			[userEmail]="userEmail$ | async"
			[emailWasScanned]="emailWasScanned$ | async">
		</vtr-email-scanner>

		<vtr-breached-account
			*ngIf="(breachedAccounts$ | async)?.length"
			[breachedAccounts]="(breachedAccounts$ | async)"
			[isUserAuthorized]="isUserAuthorized$ | async"
			[isFigleafReadyForCommunication]="isFigleafReadyForCommunication$ | async"
			(openFigleaf)="openFigleafByUrl($event)"
			(verifyClick)="startVerify()">
		</vtr-breached-account>
	</div>
</section>

<vtr-common-popup [popUpId]="confirmationPopupName">
	<ng-template>
		<vtr-confirmation-popup [popupId]="confirmationPopupName"></vtr-confirmation-popup>
	</ng-template>
</vtr-common-popup>
