<div class="scan-settings sidebar-widget">
    <div *ngIf="!isChangeSchedule">
        <div class="title pb-3">{{'smartPerformance.scanSettings.title' |translate }}</div>
        <div class="card-info">
            <p>{{'smartPerformance.scanSettings.description' |translate }}</p>
        </div>
        <ul class="chevron-list">
            <li class="d-flex justify-content-between">
                <div class="item d-flex">
                    <span class="icomoon icomoon-LE-Visible-to-online-trackers2x"></span>
                    <strong title="{{'smartPerformance.scanSettings.enableScan' |translate }}">{{'smartPerformance.scanSettings.enableScan' |translate }}</strong>
                </div>
                <div class="status d-flex justify-content-end">
                    <vtr-ui-custom-switch
                        [componentId]="'sp.enableScan'"
                        [switchParam]="'sp.enableScan'"
                        [value]="scanToggleValue"
                        (toggle)="setEnableScanStatus($event)"
                        [isDisabled] = "!isOnline">
                    </vtr-ui-custom-switch>
                    <fa-icon class="question"
                        tabindex="0"
                        triggers="manual"
                        placement="auto"
                        id=""
                        attr.aria-label=""
                        role="tooltip"
                        [ngbTooltip]="'smartPerformance.scanSettings.tooltipText' |translate"
                        #tooltip="ngbTooltip"
                        [icon]="['far', 'question-circle']"
                        container="vtr-root"
                        tooltipClass="vtr-tooltip"
                        (click)="toggleTooltip(tooltip)"
                        (keydown.enter)="toggleTooltip(tooltip)">
                    </fa-icon>
                </div>
            </li>
            <li class="d-flex justify-content-between calendar-list" 
                [ngClass]="{'disable-list':!scanToggleValue || !isOnline}" 
                (click)="changeScanSchedule()">
                <div class="item d-flex w-50">
                    <span class="icomoon icomoon-calendar"></span>
                    <strong title="{{selectedFrequency | translate}}">{{selectedFrequency | translate}}</strong>
                </div>
                <div *ngIf="loading" class="loader mr-5 mt-1"></div>
                <div *ngIf="!loading" class="status d-flex justify-content-end w-50 align-items-center" tabindex="0" (keydown.enter)="changeScanSchedule()" #scheduledScanFrequency>
                    <p class="mr-3 text-uppercase" *ngIf="(frequencyValue === 0 || frequencyValue === 1) && amPmPosition">
                        <strong *ngIf="!sliceDay">{{selectedDay | translate}}</strong> | {{ selectedMeridiem | translate }} {{scanTime.hour+':'+scanTime.min}}
                    </p>
                    <p class="mr-3 text-uppercase" *ngIf="(frequencyValue === 0 || frequencyValue === 1) && !amPmPosition">
                        <strong *ngIf="sliceDay">{{selectedDay | translate | slice:0:3}}</strong>
                        <strong *ngIf="!sliceDay">{{selectedDay | translate}}</strong> | {{scanTime.hour+':'+scanTime.min}} {{ selectedMeridiem | translate }}
                    </p>
                    <p class="mr-3 text-uppercase" *ngIf="frequencyValue === 2">
                        <strong>{{(selectedNumber)}}</strong> | {{scanTime.hour}}:{{scanTime.min}} {{selectedMeridiem | translate}}
                    </p>
                    <fa-icon [icon]="['fas', 'chevron-down']" ></fa-icon>
                </div>
            </li>
        </ul>
    </div>


    <div *ngIf="isChangeSchedule" class="change-scan-schedule">
        <div class="title pb-3">{{'smartPerformance.scanSettings.changeScanTitle' |translate }}</div>
        <div class="card-info">
            <p>{{'smartPerformance.scanSettings.changeScanDescription' |translate }}</p>
        </div>
        <ul class="chevron-list">
            <li class="d-flex justify-content-between">
                <div class="item d-flex">
                    <b>{{'smartPerformance.scanSettings.frequency' | translate }}</b>
                </div>
                <a class="status d-flex justify-content-end" 
                    tabindex="0" 
                    (keydown.enter)="openScanScheduleDropDown(1)" 
                    (click)="openScanScheduleDropDown(1)" #selectedFrequencyList>
                    {{selectedFrequency | translate}}
                    <span class="ml-3">
                        <!-- <fa-icon  *ngIf="scheduleTab != 1"
                        [icon]="['fas', 'chevron-down']"></fa-icon> -->
                        <fa-icon [icon]="scheduleTab === 1 ? ['fas', 'chevron-up'] : ['fas', 'chevron-down']"></fa-icon>
                    </span>
                </a>
                <div *ngIf="scheduleTab === 1" class="freq-dropdown">
                    <div *ngFor="let freq of scanFrequency;let ind=index" 
                        class="frequency-text"
                        [ngClass]="{'selected-frequency':frequencyValue === ind}" 
                        tabindex="0" 
                        (keydown.enter)="changeScanFrequency(ind)"
                        (click)="changeScanFrequency(ind)">
                        {{freq | translate}}
                    </div>
                </div>
            </li>

            <li *ngIf="frequencyValue === 2" class="d-flex justify-content-between">
                <div class="item d-flex">
                    <b>{{'smartPerformance.scanSettings.txtDate' |translate }}</b>
                </div>
                <a class="status d-flex justify-content-end" 
                    tabindex="0" 
                    (keydown.enter)="openScanScheduleDropDown(3)" 
                    (click)="openScanScheduleDropDown(3)" #selectedNumberList>
                    {{selectedNumber}}
                    <span class="ml-3">
                    <!-- <fa-icon *ngIf="scheduleTab != 3"
                        [icon]="['fas', 'chevron-down']"></fa-icon> -->
                        <fa-icon [icon]="scheduleTab === 3 ? ['fas', 'chevron-up'] : ['fas', 'chevron-down']"></fa-icon>
                    </span>
                </a>
                <div *ngIf="scheduleTab === 3" class="date-dropdown">
                    <div *ngFor="let date of dates;let ind=index"
                        class="date-text" 
                        [ngClass]="{'selected-date':dateValue === ind}"
                        tabindex="0" 
                        (keydown.enter)="changeScanDate(ind)"
                        (click)="changeScanDate(ind)">
                        {{date}}
                    </div>
                </div>
            </li>

            <li *ngIf="frequencyValue === 0 || frequencyValue === 1" class="d-flex justify-content-between">
                <div class="item d-flex">
                    <b>{{'smartPerformance.scanSettings.txtDay' |translate }}</b>
                </div>
                <a class="status d-flex justify-content-end" 
                    tabindex="0" 
                    (keydown.enter)="openScanScheduleDropDown(3)" 
                    (click)="openScanScheduleDropDown(3)" #selectedDayList>
                    {{selectedDay | translate}}
                    <span class="ml-3">
                        <!-- <fa-icon *ngIf="scheduleTab != 3" [icon]="['fas', 'chevron-down']"
                        ></fa-icon> -->
                        <fa-icon [icon]="scheduleTab === 3 ? ['fas', 'chevron-up'] : ['fas', 'chevron-down']"></fa-icon>
                    </span>
                </a>
                <div *ngIf="scheduleTab === 3" class="day-dropdown">
                    <div *ngFor="let day of days;let ind=index" 
                        class="days-text" 
                        [ngClass]="{'selected-day':dayValue === ind}"
                        tabindex="0" 
                        (keydown.enter)="changeScanDay(ind)"
                        (click)="changeScanDay(ind)">
                        {{day | translate}}
                    </div>
                </div>
            </li>
            <li class="d-flex justify-content-between">
                <div class="item d-flex">
                    <b>{{'smartPerformance.scanSettings.txtTime' |translate }}</b>
                </div>
                <a class="status d-flex justify-content-end" 
                    tabindex="0"  
                    (keydown.enter)="openScanScheduleDropDown(2)" 
                    (click)="openScanScheduleDropDown(2)" #timeBlock>
                    {{scanTime.hour}}:{{scanTime.min}} {{selectedMeridiem | translate}}
                    <span class="ml-3">
                    <fa-icon [icon]="scheduleTab === 2 ? ['fas', 'chevron-up'] : ['fas', 'chevron-down']"></fa-icon>
                    <!-- <fa-icon *ngIf="scheduleTab !== 2"
                    [icon]="['fas', 'chevron-down']"></fa-icon> -->
                    </span>
                </a>
                <div *ngIf="scheduleTab === 2" class="time-dropdown">
                    <div class="row">
                        <div class="col hour-block">
                            <div *ngFor="let hour of hours;let ind=index"  
                                class="hour-text"
                                [ngClass]="{'selected-text':copyScanTime.hourId === ind}"
                                tabindex="0" 
                                (keydown.enter)="changeHoursTime(ind)"
                                (click)="changeHoursTime(ind)">
                                {{hour}}
                            </div>
                        </div>
                        <div class="col minutes-block">
                            <div *ngFor="let min of mins;let ind=index" 
                                class="min-text"
                                [ngClass]="{'selected-text':copyScanTime.minId === ind}"
                                tabindex="0" 
                                (keydown.enter)="changeMinutesTime(ind)"
                                (click)="changeMinutesTime(ind)">
                                {{min}}
                            </div>
                        </div>
                        <div class="col amPm-block">
                            <div *ngFor="let ap of amPm;let ind=index"
                                class="amPm-text"
                                [ngClass]="{'selected-text':copyScanTime.amPmId === ind}"
                                tabindex="0" 
                                (keydown.enter)="changeAmPm(ind)" 
                                (click)="changeAmPm(ind)">
                                {{ ap | translate }}
                            </div>
                        </div>
                    </div>
                    <div class="row select-close py-2">
                        <div class="col text-center" 
                            (keydown.enter)="saveChangeScanTime()">
                            <fa-icon [icon]="['fal', 'check']"	tabindex="0" (click)="saveChangeScanTime()"></fa-icon>
                        </div>
                        <div class="col text-center" 
                            (keydown.enter)="cancelChangeScanTime()">
                            <fa-icon [icon]="['fal', 'times']" tabindex="0" (click)="cancelChangeScanTime()"></fa-icon>
                        </div>
                    </div>
                </div>
            </li>
        </ul>
        
        <div class="text-center">
            <button class="save-button" 
                (click)="saveChangedScanSchedule()"
                vtrMetrics
                metricsItem="btn.savechangedscanschedule"
                metricsParent="Page.Support.SmartPerformance"
                metricsEvent="FeatureClick"
                tabindex="0"
                (keydown.enter)="saveChangedScanSchedule()">
                {{'smartPerformance.scanSettings.txtSave' |translate }}
            </button>
            <a class="cancel-link active" 
                (click)="cancelChangedScanSchedule()"
                vtrMetrics
                metricsItem="btn.cancelchangedscanschedule"
                metricsParent="Page.Support.SmartPerformance"
                metricsEvent="FeatureClick"
                tabindex="0"
                (keydown.enter)="cancelChangedScanSchedule()">
                {{'smartPerformance.scanSettings.txtCancel' |translate }}
            </a>
        </div>
    </div>
</div>
